//Task 41
//Для каждого производителя, у которого присутствуют модели хотя бы в одной из таблиц PC, Laptop или Printer,
//определить максимальную цену на его продукцию.
//Вывод: имя производителя, если среди цен на продукцию данного производителя присутствует NULL,
//то выводить для этого производителя NULL, иначе максимальную цену.

SELECT maker,
    CASE
        WHEN COUNT(*) = COUNT(price)
        THEN MAX(price)
        ELSE NULL
    END
FROM (SELECT maker, q1.model, price
    FROM Product RIGHT JOIN (
        SELECT model, price
        FROM PC
        UNION
        SELECT model, price
        FROM Laptop
        UNION
        SELECT model, price
        FROM Printer ) q1 ON Product.model = q1.model) q2
GROUP BY maker