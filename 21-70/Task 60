//Task 60
//Посчитать остаток денежных средств на начало дня 15/04/2001 на каждом пункте приема для базы данных с отчетностью не чаще одного раза в день.
//Вывод: пункт, остаток.
//Замечание. Не учитывать пункты, информации о которых нет до указанной даты.

SELECT table_inc.point, sum_inc-(CASE WHEN sum_out is NULL THEN 0 ELSE sum_out END)
FROM (
    SELECT point, SUM(inc) AS sum_inc
    FROM Income_o
    WHERE date < '2001-04-15'
    GROUP BY point) as table_inc
    LEFT JOIN (
        SELECT point, SUM(out) AS sum_out
        FROM Outcome_o
        WHERE date < '2001-04-15'
        GROUP BY point) as table_out ON
        table_inc.point = table_out.point