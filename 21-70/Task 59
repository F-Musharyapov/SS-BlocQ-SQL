//Task 59
//Посчитать остаток денежных средств на каждом пункте приема для базы данных с отчетностью не чаще одного раза в день.
//Вывод: пункт, остаток.

SELECT table_inc.point, sum_inc-(
    CASE
        WHEN sum_out is NULL
        THEN 0 ELSE sum_out
    END)
FROM (
    SELECT point, SUM(inc) AS sum_inc
    FROM Income_o
    GROUP BY point) as table_inc
    LEFT JOIN
        (SELECT point, SUM(out) AS sum_out
        FROM Outcome_o
        GROUP BY point) as table_out ON
        table_inc.point = table_out.point